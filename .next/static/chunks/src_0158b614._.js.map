{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/3/chinesefoodonline/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, getApp } from \"firebase/app\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\nimport { getStorage } from \"firebase/storage\";\r\nimport { getFunctions } from \"firebase/functions\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\r\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\r\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,\r\n};\r\n\r\n// ✅ app first\r\nconst app = !getApps().length ? initializeApp(firebaseConfig) : getApp();\r\n\r\n// ✅ services after app\r\nconst db = getFirestore(app);\r\nconst storage = getStorage(app);\r\nconst auth = getAuth(app);\r\nconst functions = getFunctions(app);\r\n\r\nexport { app, db, storage, auth, functions };\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAOU;AAPV;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACf;AAEA,cAAc;AACd,MAAM,MAAM,CAAC,IAAA,8KAAO,IAAG,MAAM,GAAG,IAAA,oLAAa,EAAC,kBAAkB,IAAA,6KAAM;AAEtE,uBAAuB;AACvB,MAAM,KAAK,IAAA,kLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,8KAAU,EAAC;AAC3B,MAAM,OAAO,IAAA,wKAAO,EAAC;AACrB,MAAM,YAAY,IAAA,yLAAY,EAAC","debugId":null}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///C:/3/chinesefoodonline/src/app/admin/roles/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { getFunctions, httpsCallable } from \"firebase/functions\";\r\nimport { app, auth } from \"@/lib/firebase\";\r\nimport { onAuthStateChanged, User } from \"firebase/auth\";\r\nimport { GoogleAuthProvider, signInWithPopup, signOut } from \"firebase/auth\";\r\n\r\nexport default function RolesPage() {\r\n  const [uid, setUid] = useState(\"\");\r\n  const [role, setRole] = useState<\"admin\" | \"supporterOwner\">(\"supporterOwner\");\r\n  const [status, setStatus] = useState(\"\");\r\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\r\n  const [claims, setClaims] = useState<any>(null);\r\n  const login = async () => {\r\n  const provider = new GoogleAuthProvider();\r\n  await signInWithPopup(auth, provider);\r\n};\r\n\r\nconst logout = async () => {\r\n  await signOut(auth);\r\n};\r\n\r\n  // Watch for auth changes\r\n  useEffect(() => {\r\n    return onAuthStateChanged(auth, async (user) => {\r\n      setCurrentUser(user);\r\n      if (user) {\r\n        const tokenResult = await user.getIdTokenResult(true); // force refresh\r\n        setClaims(tokenResult.claims);\r\n      } else {\r\n        setClaims(null);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const handleAssign = async () => {\r\n    try {\r\n      const functions = getFunctions(app, \"us-central1\"); // must match region\r\n      const fn = httpsCallable(functions, \"assignRole\");\r\n\r\n      const result = await fn({ uid, role });\r\n      const data = result.data as { message: string };\r\n      setStatus(data.message);\r\n    } catch (err: any) {\r\n      console.error(err);\r\n      setStatus(\"Error assigning role: \" + err.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"p-6 max-w-lg mx-auto space-y-6\">\r\n      <h1 className=\"text-2xl font-bold\">Admin: Assign Roles</h1>\r\n\r\n      {/* Debug Panel */}\r\n      <div className=\"p-4 border rounded bg-gray-50\">\r\n        <div className=\"flex gap-2 mb-4\">\r\n  <button\r\n    onClick={login}\r\n    className=\"bg-green-600 text-white px-3 py-1 rounded\"\r\n  >\r\n    Sign in with Google\r\n  </button>\r\n  <button\r\n    onClick={logout}\r\n    className=\"bg-gray-600 text-white px-3 py-1 rounded\"\r\n  >\r\n    Sign out\r\n  </button>\r\n</div>\r\n\r\n        <h2 className=\"font-semibold mb-2\">Current User</h2>\r\n        {currentUser ? (\r\n          <div className=\"text-sm space-y-1\">\r\n            <p><strong>UID:</strong> {currentUser.uid}</p>\r\n            <p><strong>Email:</strong> {currentUser.email}</p>\r\n            <p><strong>Claims:</strong> {JSON.stringify(claims)}</p>\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-sm text-red-600\">Not signed in</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Assign Role Form */}\r\n      <div className=\"p-4 border rounded\">\r\n        <label className=\"block text-sm font-medium\">User UID</label>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Enter user UID\"\r\n          value={uid}\r\n          onChange={(e) => setUid(e.target.value)}\r\n          className=\"w-full border p-2 rounded mb-4\"\r\n        />\r\n\r\n        <label className=\"block text-sm font-medium\">Role</label>\r\n        <select\r\n          value={role}\r\n          onChange={(e) => setRole(e.target.value as \"admin\" | \"supporterOwner\")}\r\n          className=\"w-full border p-2 rounded mb-4\"\r\n        >\r\n          <option value=\"supporterOwner\">Supporter Owner</option>\r\n          <option value=\"admin\">Admin</option>\r\n        </select>\r\n\r\n        <button\r\n          onClick={handleAssign}\r\n          className=\"bg-blue-600 text-white px-4 py-2 rounded\"\r\n        >\r\n          Assign Role\r\n        </button>\r\n\r\n        {status && <p className=\"mt-4\">{status}</p>}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AAAA;;;AALA;;;;;;AAQe,SAAS;;IACtB,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAC;IAC/B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAA6B;IAC7D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAc;IAC5D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAM;IAC1C,MAAM,QAAQ;QACd,MAAM,WAAW,IAAI,mLAAkB;QACvC,MAAM,IAAA,gLAAe,EAAC,iIAAI,EAAE;IAC9B;IAEA,MAAM,SAAS;QACb,MAAM,IAAA,wKAAO,EAAC,iIAAI;IACpB;IAEE,yBAAyB;IACzB,IAAA,0KAAS;+BAAC;YACR,OAAO,IAAA,mLAAkB,EAAC,iIAAI;uCAAE,OAAO;oBACrC,eAAe;oBACf,IAAI,MAAM;wBACR,MAAM,cAAc,MAAM,KAAK,gBAAgB,CAAC,OAAO,gBAAgB;wBACvE,UAAU,YAAY,MAAM;oBAC9B,OAAO;wBACL,UAAU;oBACZ;gBACF;;QACF;8BAAG,EAAE;IAEL,MAAM,eAAe;QACnB,IAAI;YACF,MAAM,YAAY,IAAA,yLAAY,EAAC,gIAAG,EAAE,gBAAgB,oBAAoB;YACxE,MAAM,KAAK,IAAA,0LAAa,EAAC,WAAW;YAEpC,MAAM,SAAS,MAAM,GAAG;gBAAE;gBAAK;YAAK;YACpC,MAAM,OAAO,OAAO,IAAI;YACxB,UAAU,KAAK,OAAO;QACxB,EAAE,OAAO,KAAU;YACjB,QAAQ,KAAK,CAAC;YACd,UAAU,2BAA2B,IAAI,OAAO;QAClD;IACF;IAEA,qBACE,6LAAC;QAAK,WAAU;;0BACd,6LAAC;gBAAG,WAAU;0BAAqB;;;;;;0BAGnC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACrB,6LAAC;gCACC,SAAS;gCACT,WAAU;0CACX;;;;;;0CAGD,6LAAC;gCACC,SAAS;gCACT,WAAU;0CACX;;;;;;;;;;;;kCAKK,6LAAC;wBAAG,WAAU;kCAAqB;;;;;;oBAClC,4BACC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;;kDAAE,6LAAC;kDAAO;;;;;;oCAAa;oCAAE,YAAY,GAAG;;;;;;;0CACzC,6LAAC;;kDAAE,6LAAC;kDAAO;;;;;;oCAAe;oCAAE,YAAY,KAAK;;;;;;;0CAC7C,6LAAC;;kDAAE,6LAAC;kDAAO;;;;;;oCAAgB;oCAAE,KAAK,SAAS,CAAC;;;;;;;;;;;;6CAG9C,6LAAC;wBAAE,WAAU;kCAAuB;;;;;;;;;;;;0BAKxC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,WAAU;kCAA4B;;;;;;kCAC7C,6LAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;wBACtC,WAAU;;;;;;kCAGZ,6LAAC;wBAAM,WAAU;kCAA4B;;;;;;kCAC7C,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;wBACvC,WAAU;;0CAEV,6LAAC;gCAAO,OAAM;0CAAiB;;;;;;0CAC/B,6LAAC;gCAAO,OAAM;0CAAQ;;;;;;;;;;;;kCAGxB,6LAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;oBAIA,wBAAU,6LAAC;wBAAE,WAAU;kCAAQ;;;;;;;;;;;;;;;;;;AAIxC;GA3GwB;KAAA","debugId":null}}]
}