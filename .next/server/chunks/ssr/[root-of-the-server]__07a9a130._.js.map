{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/3/chinesefoodonline/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, getApp } from \"firebase/app\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\nimport { getStorage } from \"firebase/storage\";\r\nimport { getFunctions } from \"firebase/functions\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\r\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\r\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,\r\n};\r\n\r\n// ✅ app first\r\nconst app = !getApps().length ? initializeApp(firebaseConfig) : getApp();\r\n\r\n// ✅ services after app\r\nconst db = getFirestore(app);\r\nconst storage = getStorage(app);\r\nconst auth = getAuth(app);\r\nconst functions = getFunctions(app);\r\n\r\nexport { app, db, storage, auth, functions };\r\n\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACf;AAEA,cAAc;AACd,MAAM,MAAM,CAAC,IAAA,2KAAO,IAAG,MAAM,GAAG,IAAA,iLAAa,EAAC,kBAAkB,IAAA,0KAAM;AAEtE,uBAAuB;AACvB,MAAM,KAAK,IAAA,iLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,kMAAU,EAAC;AAC3B,MAAM,OAAO,IAAA,6KAAO,EAAC;AACrB,MAAM,YAAY,IAAA,sLAAY,EAAC","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/3/chinesefoodonline/src/lib/roles.ts"],"sourcesContent":["import { functions } from \"./firebase\";\r\nimport { httpsCallable } from \"firebase/functions\";\r\n\r\nconst assignRoleFn = httpsCallable(functions, \"assignRole\");\r\n\r\nexport async function assignRole(uid: string, role: \"admin\" | \"supporterOwner\") {\r\n  const result = await assignRoleFn({ uid, role });\r\n  return result.data as { message: string };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEA,MAAM,eAAe,IAAA,uLAAa,EAAC,mIAAS,EAAE;AAEvC,eAAe,WAAW,GAAW,EAAE,IAAgC;IAC5E,MAAM,SAAS,MAAM,aAAa;QAAE;QAAK;IAAK;IAC9C,OAAO,OAAO,IAAI;AACpB","debugId":null}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///C:/3/chinesefoodonline/src/app/admin/users/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { getFunctions, httpsCallable } from \"firebase/functions\";\r\nimport { app } from \"@/lib/firebase\";\r\nimport { assignRole } from \"@/lib/roles\"; // helper you already have\r\n\r\nexport default function UsersPage() {\r\n  const [query, setQuery] = useState(\"\");\r\n  const [mode, setMode] = useState<\"user\" | \"supporter\">(\"user\");\r\n  const [result, setResult] = useState<any>(null);\r\n  const [status, setStatus] = useState(\"\");\r\n\r\n  const search = async () => {\r\n    try {\r\n      const functions = getFunctions(app, \"us-central1\");\r\n\r\n      if (mode === \"user\") {\r\n        const fn = httpsCallable(functions, \"searchUsers\");\r\n        const res = await fn({ query });\r\n        setResult({ type: \"user\", data: res.data });\r\n      } else {\r\n        const fn = httpsCallable(functions, \"getSupporterOwner\");\r\n        const res = await fn({ supporterId: query });\r\n        setResult({ type: \"supporter\", data: res.data });\r\n      }\r\n\r\n      setStatus(\"\");\r\n    } catch (err: any) {\r\n      setResult(null);\r\n      setStatus(\"Error: \" + err.message);\r\n    }\r\n  };\r\n\r\n  const updateRole = async (uid: string, role: \"admin\" | \"supporterOwner\") => {\r\n    try {\r\n      const res = await assignRole(uid, role);\r\n      setStatus(res.message);\r\n    } catch (err: any) {\r\n      setStatus(\"Error assigning role: \" + err.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"p-6 max-w-xl mx-auto space-y-6\">\r\n      <h1 className=\"text-2xl font-bold\">Admin: User Management</h1>\r\n\r\n      {/* Mode Selector */}\r\n      <div className=\"flex gap-4 items-center\">\r\n        <label>\r\n          <input\r\n            type=\"radio\"\r\n            checked={mode === \"user\"}\r\n            onChange={() => setMode(\"user\")}\r\n          />\r\n          <span className=\"ml-1\">Search by User</span>\r\n        </label>\r\n        <label>\r\n          <input\r\n            type=\"radio\"\r\n            checked={mode === \"supporter\"}\r\n            onChange={() => setMode(\"supporter\")}\r\n          />\r\n          <span className=\"ml-1\">Search by Supporter</span>\r\n        </label>\r\n      </div>\r\n\r\n      {/* Search Box */}\r\n      <div className=\"flex gap-2\">\r\n        <input\r\n          type=\"text\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          placeholder={\r\n            mode === \"user\"\r\n              ? \"Enter email, phone, or UID\"\r\n              : \"Enter supporter slug\"\r\n          }\r\n          className=\"flex-1 border p-2 rounded\"\r\n        />\r\n        <button\r\n          onClick={search}\r\n          className=\"bg-blue-600 text-white px-4 py-2 rounded\"\r\n        >\r\n          Search\r\n        </button>\r\n      </div>\r\n\r\n      {status && <p className=\"text-sm text-red-600\">{status}</p>}\r\n\r\n      {/* Result */}\r\n   {Array.isArray(result?.data) && result.data.length > 0 ? (\r\n  result.data.map((u: any) => (\r\n    <div key={u.uid} className=\"p-4 border rounded bg-gray-50 mb-4\">\r\n      <p><strong>UID:</strong> {u.uid}</p>\r\n      <p><strong>Email:</strong> {u.email}</p>\r\n      <p><strong>Phone:</strong> {u.phoneNumber}</p>\r\n      <p><strong>Name:</strong> {u.displayName}</p>\r\n      <p><strong>Claims:</strong> {JSON.stringify(u.roles || {})}</p>\r\n\r\n      <div className=\"mt-2 flex gap-2\">\r\n        <button\r\n          onClick={() => updateRole(u.uid, \"supporterOwner\")}\r\n          className=\"bg-green-600 text-white px-3 py-1 rounded\"\r\n        >\r\n          Make Supporter Owner\r\n        </button>\r\n        <button\r\n          onClick={() => updateRole(u.uid, \"admin\")}\r\n          className=\"bg-purple-600 text-white px-3 py-1 rounded\"\r\n        >\r\n          Make Admin\r\n        </button>\r\n      </div>\r\n    </div>\r\n  ))\r\n) : (\r\n  <p>No users found</p>\r\n)}\r\n\r\n\r\n      {result?.type === \"supporter\" && (\r\n        <div className=\"p-4 border rounded bg-gray-50\">\r\n          <p><strong>Supporter ID:</strong> {result.data.supporterId}</p>\r\n          <p><strong>Owner UID:</strong> {result.data.ownerUserId || \"No owner\"}</p>\r\n\r\n          {result.data.owner ? (\r\n            <>\r\n              <p><strong>Email:</strong> {result.data.owner.email}</p>\r\n              <p><strong>Phone:</strong> {result.data.owner.phoneNumber}</p>\r\n              <p><strong>Name:</strong> {result.data.owner.displayName}</p>\r\n              <p><strong>Claims:</strong> {JSON.stringify(result.data.owner.customClaims)}</p>\r\n\r\n              <div className=\"mt-4 flex gap-2\">\r\n                <button\r\n                  onClick={() => updateRole(result.data.owner.uid, \"supporterOwner\")}\r\n                  className=\"bg-green-600 text-white px-3 py-1 rounded\"\r\n                >\r\n                  Make Supporter Owner\r\n                </button>\r\n                <button\r\n                  onClick={() => updateRole(result.data.owner.uid, \"admin\")}\r\n                  className=\"bg-purple-600 text-white px-3 py-1 rounded\"\r\n                >\r\n                  Make Admin\r\n                </button>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <p className=\"text-sm text-gray-600\">No linked owner</p>\r\n          )}\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}